import{r as h,m as T,f as P,q as B,o as i,c,_ as L,a as l,F as S,n as $,s as j,t as w,v as Y,d as N,x as V,y as C,b as k,w as M}from"./B2vMvYnC.js";import{_ as E}from"./Byx56mRJ.js";import{g as U}from"./D5UyPOWT.js";import{u as q}from"./CMNDWsMZ.js";const A=window.setInterval,R={class:"aspect-w-16 aspect-h-9 relative"},z=["src"],D=["id"],F={__name:"YouTubePlayer",props:{videoId:{type:String,required:!0}},emits:["timeUpdate"],setup(u,{expose:f,emit:p}){const v=u,_=p,d=h(`youtube-player-${Math.random().toString(36).substr(2,9)}`),m=h(!1);let t=null;const n=()=>new Promise(o=>{if(window.YT&&window.YT.Player)o(window.YT);else{const b=document.createElement("script");b.src="https://www.youtube.com/iframe_api";const I=document.getElementsByTagName("script")[0];I.parentNode.insertBefore(b,I),window.onYouTubeIframeAPIReady=()=>o(window.YT)}}),r=o=>{t=new o.Player(d.value,{height:"100%",width:"100%",videoId:v.videoId,playerVars:{autoplay:0,modestbranding:1,rel:0,origin:window.location.origin},events:{onReady:s,onStateChange:y}})},s=o=>{},y=o=>{},e=()=>{if(t&&t.getCurrentTime){const o=t.getCurrentTime();_("timeUpdate",{minutes:Math.floor(o/60),seconds:Math.floor(o%60)})}},a=async()=>{m.value=!0;const o=await n();r(o)},x=o=>{t&&t.seekTo&&t.seekTo(o)};T(()=>{a()});let g=null;return P(()=>v.videoId,o=>{t&&t.loadVideoById&&t.loadVideoById(o)}),T(()=>{g=A(e,100)}),B(()=>{t&&t.destroy&&t.destroy(),g&&clearInterval(g)}),f({seekTo:x}),(o,b)=>(i(),c("div",R,[m.value?(i(),c("div",{key:1,id:d.value,class:"w-full h-full"},null,8,D)):(i(),c("img",{key:0,src:`https://img.youtube.com/vi/${u.videoId}/0.jpg`,onClick:a,class:"w-full h-full object-cover cursor-pointer"},null,8,z))]))}},G={key:0,class:"space-y-2 text-base sm:text-lg"},O=["onClick"],W={class:"text-sm text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0 w-16 text-right content-center"},H={class:"lyrics-line flex-grow"},J={key:0},K={key:1,class:"text-gray-600 dark:text-gray-400"},Q={__name:"LyricsDisplay",props:{lyrics:{type:Array,default:()=>[]},currentTime:{type:Object,required:!0}},emits:["seekTo"],setup(u,{emit:f}){const p=u,v=f,_=n=>{const r=p.currentTime.minutes*60+p.currentTime.seconds,s=n.time.minutes*60+n.time.seconds,y=s+n.time.length;return r>=s&&r<y},d=(n,r)=>{const s=[];return n.split("//").forEach((e,a)=>{const x=r==null?void 0:r.find(g=>g.text===e);x?s.push({text:e,furigana:x.reading}):s.push({text:e})}),s},m=n=>{const r=n.minutes.toString().padStart(2,"0"),s=n.seconds.toString().padStart(2,"0");return`[${r}:${s}]`},t=n=>{v("seekTo",n)};return(n,r)=>(i(),c("div",null,[r[0]||(r[0]=l("h2",{class:"text-2xl sm:text-3xl font-semibold mb-6 text-gray-800 dark:text-gray-200"},"Lyrics",-1)),u.lyrics&&u.lyrics.length>0?(i(),c("div",G,[(i(!0),c(S,null,$(u.lyrics,(s,y)=>(i(),c("div",{key:y,class:j([{"font-bold text-blue-600 dark:text-blue-400":_(s),"text-gray-700 dark:text-gray-300":!_(s)},"flex transition-all duration-300 ease-in-out leading-relaxed cursor-pointer"]),onClick:e=>t(s.time)},[l("span",W,w(m(s.time)),1),l("div",H,[(i(!0),c(S,null,$(d(s.text,s.furigana),(e,a)=>(i(),c("ruby",{key:a},[e.furigana?(i(),c("rt",J,w(e.furigana),1)):Y("",!0),N(" "+w(e.text),1)]))),128))])],10,O))),128))])):(i(),c("div",K," No lyrics available. "))]))}},X=L(Q,[["__scopeId","data-v-382ab3c5"]]),Z={key:0,class:"px-4 py-8"},ee={class:"text-2xl sm:text-3xl font-bold mb-2 text-center text-blue-600 dark:text-blue-400"},te={class:"text-lg sm:text-xl font-semibold mb-4 text-center text-gray-600 dark:text-gray-400"},se={class:"mb-8 max-w-3xl mx-auto"},oe={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4 sm:p-6 mb-8 max-w-3xl mx-auto"},ne={key:1,class:"text-center text-gray-600 dark:text-gray-400"},re={class:"text-center space-x-4 flex justify-center items-center"},ae=["href"],ue={__name:"song",setup(u){const f=V(),p=h({minutes:0,seconds:0}),{songs:v,fetchSongs:_}=q(),d=h([]),m=h(null),t=C(()=>v.value.find(e=>e.videoId===f.query.id)),n=C(()=>t.value?U(t.value.videoId):""),r=async e=>{try{const x=await(await fetch(`/lyrics/${e}.json`)).json();d.value=x.lyrics}catch{d.value=[]}};T(async()=>{await _()}),P(()=>f.query.id,async e=>{e&&await r(e)},{immediate:!0});const s=e=>{p.value=e},y=e=>{if(m.value){const a=e.minutes*60+e.seconds;m.value.seekTo(a)}};return(e,a)=>{const x=F,g=X,o=E;return t.value?(i(),c("div",Z,[l("h1",ee,w(t.value.title),1),l("h2",te,w(t.value.artist),1),l("div",se,[k(x,{videoId:t.value.videoId,onTimeUpdate:s,ref_key:"youtubePlayer",ref:m},null,8,["videoId"])]),d.value.length>0?(i(),c("div",oe,[k(g,{lyrics:d.value,currentTime:p.value,onSeekTo:y},null,8,["lyrics","currentTime"])])):(i(),c("div",ne," Loading lyrics... ")),l("div",re,[k(o,{to:"/",class:"inline-flex items-center justify-center bg-blue-500 text-white p-2 rounded-full hover:bg-blue-600 transition duration-300",title:"Back to Song Gallery"},{default:M(()=>a[0]||(a[0]=[l("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])),_:1}),l("a",{href:n.value,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center justify-center bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition duration-300",title:"Watch on YouTube"},a[1]||(a[1]=[l("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[l("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})],-1)]),8,ae)])])):Y("",!0)}}};export{ue as default};
