import{r as w,m as T,f as P,q as Y,o as a,c as i,_ as B,a as d,F as S,n as $,s as j,t as b,v as L,d as N,x as V,y as C,b as k,w as M,z as U}from"./uOP4dqhU.js";import{_ as E}from"./CdR1gS6o.js";import{g as R}from"./D5UyPOWT.js";import{u as q}from"./dU9ijK35.js";const A=window.setInterval,z={class:"aspect-w-16 aspect-h-9 relative"},D=["src"],F=["id"],G={__name:"YouTubePlayer",props:{videoId:{type:String,required:!0}},emits:["timeUpdate"],setup(y,{expose:f,emit:g}){const v=y,_=g,u=w(`youtube-player-${Math.random().toString(36).substr(2,9)}`),x=w(!1);let n=null;const e=()=>new Promise(o=>{if(window.YT&&window.YT.Player)o(window.YT);else{const h=document.createElement("script");h.src="https://www.youtube.com/iframe_api";const I=document.getElementsByTagName("script")[0];I.parentNode.insertBefore(h,I),window.onYouTubeIframeAPIReady=()=>o(window.YT)}}),r=o=>{n=new o.Player(u.value,{height:"100%",width:"100%",videoId:v.videoId,playerVars:{autoplay:0,modestbranding:1,rel:0,origin:window.location.origin},events:{onReady:t,onStateChange:p}})},t=o=>{},p=o=>{},l=()=>{if(n&&n.getCurrentTime){const o=n.getCurrentTime();_("timeUpdate",{minutes:Math.floor(o/60),seconds:Math.floor(o%60)})}},s=async()=>{x.value=!0;const o=await e();r(o)},c=o=>{n&&n.seekTo&&n.seekTo(o)};T(()=>{s()});let m=null;return P(()=>v.videoId,o=>{n&&n.loadVideoById&&n.loadVideoById(o)}),T(()=>{m=A(l,100)}),Y(()=>{n&&n.destroy&&n.destroy(),m&&clearInterval(m)}),f({seekTo:c}),(o,h)=>(a(),i("div",z,[x.value?(a(),i("div",{key:1,id:u.value,class:"w-full h-full"},null,8,F)):(a(),i("img",{key:0,src:`https://img.youtube.com/vi/${y.videoId}/0.jpg`,onClick:s,class:"w-full h-full object-cover cursor-pointer"},null,8,D))]))}},O={key:0,class:"space-y-2 text-base sm:text-lg"},W=["onClick"],H={class:"text-sm text-gray-500 dark:text-gray-400 mr-2 flex-shrink-0 w-16 text-right content-center"},J={class:"lyrics-line flex-grow"},K={key:0},Q={key:1,class:"text-gray-600 dark:text-gray-400"},X={__name:"LyricsDisplay",props:{lyrics:{type:Array,default:()=>[]},currentTime:{type:Object,required:!0}},emits:["seekTo"],setup(y,{emit:f}){const g=y,v=f,_=e=>{const r=g.currentTime.minutes*60+g.currentTime.seconds,t=e.time.minutes*60+e.time.seconds,p=t+e.time.length;return r>=t&&r<p},u=(e,r)=>{const t=[];return e.split("//").forEach((l,s)=>{const c=r==null?void 0:r.find(m=>m.text===l);c?t.push({text:l,furigana:c.reading}):t.push({text:l})}),t},x=e=>{const r=e.minutes.toString().padStart(2,"0"),t=e.seconds.toString().padStart(2,"0");return`[${r}:${t}]`},n=e=>{v("seekTo",e)};return(e,r)=>(a(),i("div",null,[r[0]||(r[0]=d("h2",{class:"text-2xl sm:text-3xl font-semibold mb-6 text-gray-800 dark:text-gray-200"},"Lyrics",-1)),y.lyrics&&y.lyrics.length>0?(a(),i("div",O,[(a(!0),i(S,null,$(y.lyrics,(t,p)=>(a(),i("div",{key:p,class:j([{"font-bold text-blue-600 dark:text-blue-400":_(t),"text-gray-700 dark:text-gray-300":!_(t)},"flex transition-all duration-300 ease-in-out leading-relaxed cursor-pointer"]),onClick:l=>n(t.time)},[d("span",H,b(x(t.time)),1),d("div",J,[(a(!0),i(S,null,$(u(t.text,t.furigana),(l,s)=>(a(),i("ruby",{key:s},[l.furigana?(a(),i("rt",K,b(l.furigana),1)):L("",!0),N(" "+b(l.text),1)]))),128))])],10,W))),128))])):(a(),i("div",Q," No lyrics available. "))]))}},Z=B(X,[["__scopeId","data-v-382ab3c5"]]),ee={key:0,class:"px-4 py-8"},te={class:"text-2xl sm:text-3xl font-bold mb-2 text-center text-blue-600 dark:text-blue-400"},se={class:"text-lg sm:text-xl font-semibold mb-4 text-center text-gray-600 dark:text-gray-400"},oe={class:"mb-8 max-w-3xl mx-auto"},ne={key:0,class:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4 sm:p-6 mb-8 max-w-3xl mx-auto"},re={key:1,class:"text-center text-gray-600 dark:text-gray-400"},ae={class:"text-center space-x-4 flex justify-center items-center"},ie=["href"],me={__name:"song",setup(y){const f=V(),g=w({minutes:0,seconds:0}),{songs:v,fetchSongs:_}=q(),u=w([]),x=w(null),n=U(),e=C(()=>v.value.find(s=>s.videoId===f.query.id)),r=C(()=>e.value?R(e.value.videoId):""),t=async s=>{try{const m=await(await fetch(`${n.app.baseURL}lyrics/${s}.json`)).json();u.value=m.lyrics}catch{u.value=[]}};T(async()=>{await _()}),P(()=>f.query.id,async s=>{s&&await t(s)},{immediate:!0});const p=s=>{g.value=s},l=s=>{if(x.value){const c=s.minutes*60+s.seconds;x.value.seekTo(c)}};return(s,c)=>{const m=G,o=Z,h=E;return e.value?(a(),i("div",ee,[d("h1",te,b(e.value.title),1),d("h2",se,b(e.value.artist),1),d("div",oe,[k(m,{videoId:e.value.videoId,onTimeUpdate:p,ref_key:"youtubePlayer",ref:x},null,8,["videoId"])]),u.value.length>0?(a(),i("div",ne,[k(o,{lyrics:u.value,currentTime:g.value,onSeekTo:l},null,8,["lyrics","currentTime"])])):(a(),i("div",re," Loading lyrics... ")),d("div",ae,[k(h,{to:"/",class:"inline-flex items-center justify-center bg-blue-500 text-white p-2 rounded-full hover:bg-blue-600 transition duration-300",title:"Back to Song Gallery"},{default:M(()=>c[0]||(c[0]=[d("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)])),_:1}),d("a",{href:r.value,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center justify-center bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition duration-300",title:"Watch on YouTube"},c[1]||(c[1]=[d("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[d("path",{d:"M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"})],-1)]),8,ie)])])):L("",!0)}}};export{me as default};
